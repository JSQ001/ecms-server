<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.eicas.ecms.mapper.MenuMapper">
    <select id="getTree" resultMap="resultMap_menu">
        select * from sys_menu
        <where>
            sys_menu.is_deleted = 0
            <if test="id != null and id != ''">
                and parent_id=#{id}
            </if>
            <if test="id == null or id == ''">
                and ISNULL(parent_id)
            </if>
        </where>
    </select>

    <select id="getList" resultMap="resultMap_menu">
        select * from sys_menu
        <where>
            sys_menu.is_deleted = 0
            and ISNULL(parent_id)
            <if test="entity.id != null and entity.id != ''">
                and id=#{id}
            </if>
        </where>
    </select>



    <resultMap type="com.eicas.ecms.entity.Menu" id="resultMap_menu">
        <id column="id" property="id"/>
        <result column="menu_name" property="menuName"/>
        <result column="parent_id" property="parentId"/>
        <result column="icon_id" property="iconId"/>
        <result column="path" property="path"/>
        <result column="deleted" property="deleted"/>
        <!--id作为参数递归调用getDeptTree，查询子节点-->
        <collection property="children" column="id" select="getTree" />
        <collection property="roles" column="id" select="com.eicas.ecms.mapper.MenuRoleMapper.queryByMenuId"/>
    </resultMap>
</mapper>
